<style>
  td,
  tr {
    padding: 8px;
  }

  blockquote {
    margin: 0 7px 0 5px;
    padding: 0 16px 0 10px;
  }

  blockquote p {
    font-weight: bold;
    border: 2px 2px 2px 0 solid black;
    color: rgb(217, 0, 0);
  }

  img {
    border: 2px solid black;
  }

  .code-highlight2 {
    font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New",
      monospace, "Droid Sans Fallback";
    font-size: 14px;
    padding-left: 4px;
    color: rgb(217, 0, 0);
  }

  .bash {
    background: black;
    font: white;
    font-family: Courier, Courier new, Serif;
    width: auto;
    height: auto;
  }

  /* body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */
  /* 
.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
} */

  /* Tomorrow Theme */
  /* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
  /* Original theme - https://github.com/chriskempson/tomorrow-theme */

  /* Tomorrow Comment */
  /* .hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
  /*
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
  /* .hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
} */

  /* Tomorrow Yellow */
  /* .hljs-attribute {
    color: #eab700;
  } */

  /* Tomorrow Green
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
} */

  /* Tomorrow Blue */
  /* .hljs-title,
.hljs-section {
	color: #4271ae;
} */

  /* Tomorrow Purple */
  /* .hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
} */

  /*
 * Markdown PDF CSS
 */

  /* pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
} */

  /* for inline code */
  /* :not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
  /* font-size: inherit; */
  /* } */
</style>

<h1 id="scale-the-cluster-updown-on-yugabyte-platform-anywhere">
  Scale the Cluster (up/down) on Yugabyte Platform (Anywhere)
</h1>
<h2 id="introduction">Introduction</h2>
<p>
  In this hands-on lab, you will scale a cluster up and down to demonstrate how
  a universe using Yugabyte Platform is able to react to a change in the
  capacity of the cluster. In the real world, the need to change a cluster's
  capacity could arise due to any number of reasons including increases in
  traffic due to a special event or a hardware failure. Demonstrating the
  dynamic auto load balancing ability of a Yugabyte universe is a critical POC
  to any client.
</p>
<p>
  This lab will use a three-node multi-zone single region universe that has run
  the <code class="code-highlight2">SqlInserts</code>, <code class="code-highlight2">SqlSecondaryIndex</code>, and
  <code class="code-highlight2">SqlSnapshotTxns</code> key-value YSQL workloads on AWS.
</p>
<h3 id="objective">Objective</h3>
<p>
  As a sales engineer, I want to demonstrate the auto load balancing ability of
  the Yugabyte universe when the cluster is scaled up or scaled down.
</p>
<h2 id="prerequisites">Prerequisites</h2>
<ul>
  <li>
    <p>
      A deployed three node universe on AWS will be used to demonstrate scaling
      up and down. For information on how to deploy a universe, review a
      previous lab on multi-zone universe deployment.
    </p>
  </li>
  <li>
    <p>
      The universe will run the <code class="code-highlight2">SqlInserts</code>,
      <code class="code-highlight2">SqlSecondaryIndex</code>, and <code class="code-highlight2">SqlSnapshotTxns</code> YSQL
      key-value workloads from the
      <a href="https://github.com/yugabyte/yb-sample-apps"
        ><code class="code-highlight2">yb-sample-apps</code> repository</a
      >. For a detailed overview on how to do this, review the lab on running
      YSQL workloads on a Yugabyte universe.
    </p>
  </li>
</ul>
<h2 id="scale-up-a-yugabyte-universe">Scale Up a Yugabyte Universe</h2>
<p>
  In this step, you will scale up the Yugabyte universe. You will increase the
  available capacity by adding a node to the current three node cluster and note
  the speed at which the universe is able to auto balance the workload.
</p>
<p>
  Normally scaling up a cluster is necessary whenever the current cluster
  topology is inadequate to handle a workload. That could be due to an increase
  in traffic due to a growth in an app's popularity or there is an expected
  spike in traffic due to a special event or promotion.
</p>
<p>
  The first step is to sign into Yugabyte Platform and select the universe that
  is running the YSQL workloads. Any workload will do for this lab however, but
  we will use this workload's usage metrics to illustrate the workload changes
  for each node.
</p>
<p>
  You will see the universe details page once the universe has been selected:
</p>
<p>
  <img
    src="file:///Users/markkim/Documents/YBU_repos/YBU_public/TFE/YBU-66/assets/images/100-universe_overview_1600x700.png"
    alt="The Yugabyte universe overview page displays the current workloads."
  />
</p>
<p>
  In the preceding image, you can see that this universe is a three node cluster
  with four tables actively processing writes and reads.
</p>
<p>
  Select the &quot;Actions&quot; dropdown button located under the profile icon
  in the upper right corner of the page.
</p>
<p>
  Select the &quot;Edit Universe&quot; option from the dropdown list to navigate
  to the following form:
</p>
<p>
  <img
    src="file:///Users/markkim/Documents/YBU_repos/YBU_public/TFE/YBU-66/assets/images/150-add_node_1600x700.png"
    alt="Scale up this cluster by increasing the amount of nodes in this Yugabyte universe."
  />
</p>
<p>
  Notice that in the preceding form the value for the &quot;Nodes&quot; has been
  increased from three to four. Also note a node was added to one of the
  availability zones in the universe automatically.
</p>
<p>Select &quot;Save&quot; at the bottom of the page.</p>
<p>
  You will then be redirected to the universe details page where a status bar
  indicates the progress of the new task.
</p>
<p>
  Select the &quot;Nodes&quot; tab on the universe details page to see that the
  new node has been added but its status is currently &quot;Unreachable&quot;.
  Once this process has concluded, you will see that the new node has changed to
  &quot;Live&quot; status as shown in the following image:
</p>
<p>
  <img
    src="file:///Users/markkim/Documents/YBU_repos/YBU_public/TFE/YBU-66/assets/images/200-four_node_1600x700.png"
    alt="A new node has been successfully added to the Yugabyte universe."
  />
</p>
<p>
  Notice in the preceding image that within a few minutes, the new node has
  successfully begun to rebalance the workload from the other nodes. The new
  node is actively participating in the universe by receiving read and write
  operations. The SST or Sorted String Tables have also been distributed to the
  new node. Notice that the <code class="code-highlight2">TServer</code> process, but not the
  <code class="code-highlight2">Master</code> process, is running on the new node. This is due to the
  Raft consensus algorithm which ties the number of
  <code class="code-highlight2">Master</code> processes in a cluster to the Replication Factor, which is
  three in this universe. For more details on this, review the
  <a
    href="https://blog.yugabyte.com/how-does-the-raft-consensus-based-replication-protocol-work-in-yugabyte-db/"
    >blog post regarding the Raft Consensus Replication Protocol.</a
  >
</p>
<h2 id="scale-down-a-yugabyte-universe">Scale Down a Yugabyte Universe</h2>
<p>
  In the last step, you scaled up a Yugabyte universe by adding a node. This
  demonstrated how a universe is able to auto balance the read and write
  operations onto the new node. In this step, you will scale the universe down
  by removing a node.
</p>
<p>
  Navigate to the &quot;Nodes&quot; tab on the Yugabyte Platform console to view
  the current configuration of four nodes as shown in the following image:
</p>
<p>
  <img
    src="file:///Users/markkim/Documents/YBU_repos/YBU_public/TFE/YBU-66/assets/images/200-four_node_1600x700.png"
    alt="A four node cluster has auto balanced the read and write operations."
  />
</p>
<p>
  Select the &quot;Actions&quot; button for the new node that was added in the
  last step.
</p>
<p>Select &quot;Remove Node&quot; from the dropdown list.</p>
<p>
  In a few minutes, the new node will be removed from the universe with the
  &quot;Removed&quot; status as shown in the following image:
</p>
<p>
  <img
    src="file:///Users/markkim/Documents/YBU_repos/YBU_public/TFE/YBU-66/assets/images/400-remove_node_1600x700.png"
    alt="Remove a node from the cluster."
  />
</p>
<p>
  As the universe removes the node, notice that the read and write operations
  are automatically rebalanced on the remaining nodes in the cluster. Within a
  few minutes, the universe has rebalanced the workload including the SST files
  onto the remaining working nodes.
</p>
<p>
  Notice on the universe Overview page in the following image, that the latency
  of the read and write operations were only momentarily affected by the removal
  of a node:
</p>
<p>
  <img
    src="file:///Users/markkim/Documents/YBU_repos/YBU_public/TFE/YBU-66/assets/images/300-latency_1600x700.png"
    alt="A momentary change in the average latency."
  />
</p>
<blockquote>
  <p>
    <strong>Pro Tip:</strong> Note that a node can also be removed by editing
    the universe and reducing the number of nodes, similar to the process of
    adding a node that was completed in a previous step in this lab.
  </p>
</blockquote>
<h2 id="reflection">Reflection</h2>
<p>
  In this lab, you added a node to increase the capacity of a Yugabyte universe
  and noted how the workloads were auto balanced within a few minutes.
</p>
<p>
  You also removed a node from the universe and discovered how the SST files and
  read/write capacity were evenly distributed between the remaining nodes to
  maintain consistent read and write operations regardless of the cluster's
  specific topology.
</p>
